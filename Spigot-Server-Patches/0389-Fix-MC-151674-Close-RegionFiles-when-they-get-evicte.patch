From 4e77b273a6312dfb0f96db8d75f310c0c5e47bb3 Mon Sep 17 00:00:00 2001
From: Spottedleaf <Spottedleaf@users.noreply.github.com>
Date: Sun, 12 May 2019 19:25:53 -0700
Subject: [PATCH] Fix MC-151674 Close RegionFiles when they get evicted from
 cache

https://bugs.mojang.com/browse/MC-151674

diff --git a/src/main/java/net/minecraft/server/RegionFileCache.java b/src/main/java/net/minecraft/server/RegionFileCache.java
index 844f491c70..1371834817 100644
--- a/src/main/java/net/minecraft/server/RegionFileCache.java
+++ b/src/main/java/net/minecraft/server/RegionFileCache.java
@@ -56,7 +56,7 @@ public abstract class RegionFileCache implements AutoCloseable {
             return regionfile;
         } else {
             if (this.cache.size() >= PaperConfig.regionFileCacheSize) {
-                this.cache.removeLast();
+                this.cache.removeLast().close(); // Paper - MC-151674
             }
 
             if (!this.a.exists()) {
-- 
2.21.0

