From 621472f2b2e720d3167f64288f1d8a5c293d85eb Mon Sep 17 00:00:00 2001
From: Zach Brown <Zbob750@live.com>
Date: Wed, 2 Jul 2014 22:33:09 -0500
Subject: [PATCH] Allow undead horse types to be leashed


diff --git a/src/main/java/net/minecraft/server/EntityHorse.java b/src/main/java/net/minecraft/server/EntityHorse.java
index 76bde8c..dee187c 100644
--- a/src/main/java/net/minecraft/server/EntityHorse.java
+++ b/src/main/java/net/minecraft/server/EntityHorse.java
@@ -5,6 +5,8 @@ import java.util.List;
 
 import org.bukkit.event.entity.EntityRegainHealthEvent.RegainReason; // CraftBukkit
 
+import org.github.paperspigot.PaperSpigotWorldConfig; // PaperSpigot
+
 public class EntityHorse extends EntityAnimal implements IInventoryListener {
 
     private static final IEntitySelector bu = new EntitySelectorHorse();
@@ -169,7 +171,13 @@ public class EntityHorse extends EntityAnimal implements IInventoryListener {
     }
 
     public boolean bM() {
-        return !this.cE() && super.bM();
+        // PaperSpigot start - configurable undead horse leashing
+        if (PaperSpigotWorldConfig.allowUndeadHorseLeashing) {
+            return super.bM();
+        } else {
+            return !this.cE() && super.bM();
+        }
+        // PaperSpigot end
     }
 
     protected void o(float f) {
diff --git a/src/main/java/org/github/paperspigot/PaperSpigotWorldConfig.java b/src/main/java/org/github/paperspigot/PaperSpigotWorldConfig.java
index 95298f3..1eb5e47 100644
--- a/src/main/java/org/github/paperspigot/PaperSpigotWorldConfig.java
+++ b/src/main/java/org/github/paperspigot/PaperSpigotWorldConfig.java
@@ -74,4 +74,11 @@ public class PaperSpigotWorldConfig
         config.addDefault( "world-settings.default." + path, def );
         return config.getString( "world-settings." + worldName + "." + path, config.getString( "world-settings.default." + path ) );
     }
-}
\ No newline at end of file
+
+    public static boolean allowUndeadHorseLeashing;
+    private void allowUndeadHorseLeashing()
+    {
+        allowUndeadHorseLeashing = getBoolean( "allow-undead-horse-leashing", true );
+        log( "Allow undead horse types to be leashed: " + allowUndeadHorseLeashing );
+    }
+}
-- 
1.9.1

